from Crypto.Util.number import long_to_bytes, bytes_to_long
import base64
from gmpy2 import invert
n = 0xABE9BB887BAB05AF46F2E8C4893A59EF5687395361417A5DEA3090361C0C377843E891E4BF41D2C662707C67B41275C3B6346B696992E8E6334F8F8B4AB5ECCFD224586CD1949E250BB5874BC0F735621660708FE1346DD8DD139565D69BD9C50AB117A90DC85A0610A50BCACEC76C7AD9C86492F5B5FD70433184EAB6E46EF51195405BCC14AE89D9268B4918E50C69D897DBE8E508EB8EF3C7674FC49A437DF48235F7D52035183AFAE0631221B391E6085DD71020B755F68AB5171E2F924CF11D2ACF99D553636CF213EF4953FEEFF8BB1B8E3B7235B5E75B22D23A01ED1A41A65BB8E1593C4D75C3024D0965D5BA2B0267EC84DA5F4E0000000000000001
e = 65537
p = 139457081371053313087662621808811891689477698775602541222732432884929677435971504758581219546068100871560676389156360422970589688848020499752936702307974617390996217688749392344211044595211963580524376876607487048719085184308509979502505202804812382023512342185380439620200563119485952705668730322944000000001
q = 155617827023249833340719354421664777126919280716316528121008762838820577123085292134385394346751341309377546683859340593439660968379640585296350265350950535158375685103003837903550191128377455111656903429282868722284520586387794090131818535032744071918282383650099890243578253423157468632973312000000000000001
d = invert(e, (p-1)*(q-1))
assert(p*q == n)
#msg = open("msg.txt",'r')
#msg = msg.read()
msg = "ZAdiL2s3fO5njWJX8oGJPVHVE8IYqS462D1ZsoESKr2hnn4eg0ywvgnLRevsUV4slD3wA9W7Kpuh2n7iIIaPBRH/zJEuA+B0LXNdgWxxcOyOZLrEOGR+BKu5a5MOKBBBgop6+PaxMEex+7JjZJSIfp5gwDdwzKXUmp/n7G+LVwReHmmTp+dTwOj9cRzQKKCrEESce4pgaFO6xXRYSivJ73SqKhC4nl7Nd7WFILqJev/iEotk18UkIhStLdjt1Z+86M1rnkf9H5xAtz3ZFjCTPoLb4DrIdrCSmffIvQknHjGJUckbmK1UUrwNlmh4sx6vpZSlCNVZEKr6tlT/1r/GUw=="
a = bytes_to_long(base64.b64decode(msg))
s = 0
while True:
    a = pow(a, d, n)
    if(b'flag' in long_to_bytes(a)):
        print(long_to_bytes(a))
        print(f"s={s}")
        break
    s += 1
